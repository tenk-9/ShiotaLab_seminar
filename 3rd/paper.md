# 「話者認識システムとなりすまし対策」を読み，まとめる
- https://www.jstage.jst.go.jp/article/jasj/78/6/78_338/_article/-char/ja/

## 概要
- 
## 話者認識とは
- 音声を生体認証の鍵として用いる
- 定義による分類
  - 話者識別
    - 事前に登録した複数の候補者の中から提示された音声の話者を探索する
    - 1対n
  - 話者照合
    - 提示された二つの音声が同一話者によるものか否かを判定する
    - 1対1
    - 多くの研究は話者照合を対象にしている
      - 誤り率が話者数に依存しない
      - 未知の話者を含む大量の音声の評価も容易にできる
- 音声内容による分類
  - テキスト依存型
    - 登録時と照合時で同じ内容の音声を用いる
  - テキスト独立型
    - 登録時と照合時で異なる内容の音声を用いる
## 話者照合システムの原理
システムの流れにより大別される．
- エンドツーエンド型
  - 登録，照合音声のペアから照合スコアを直接計算する
    - 動的時間短縮(DTW)に基づく方法はこれ
      - `話者認識で用いる機械学習/p1`
- フロントエンド・バックグラウンド型
  - 音声から特徴量を抽出
  - 特徴量に基づき照合スコアを計算
  - 現在主流

フロントエンド・バックエンド型の処理の流れは次のよう．
1. 特徴量抽出
   - スペクトル包絡に基づく特徴量
     - MFCC(mel-frequency Cepstral coefficients)
       - メル周波数ケプストラム係数
         - メル周波数
           - 人間の音高知覚が考慮された尺度
           - メルスペクトルグラムは周波数の次元数が小さくなる
             - 聴覚特性に基づいた次元圧縮
         - ケプストラム
           - >音声信号のフーリエ変換の絶対値に対数をかけ、さらに逆フーリエ変換（フーリエ変換とする場合もある）したもの。
     - PLP(perceptual linear prediction)
   - フィルタバンク特徴量
     - 上のやつより生の信号に近い
   - 発話区間検出による無音区間の除去も行われる
   - 伝送経路等の影響を除去するため，特徴量の各次元について3秒程度の移動窓ごとに平均や分散を正規化する
2. 話者埋め込み抽出
   - 発話内容，収録環境，伝送路等の違いにより話者内で特徴量は大きく変わる
   - 特徴量の系列長は入力音声の長さに依存する
     - 系列長の違うを吸収する仕組みが必要
       -  音韻の違い等話者に依らない変動は抑圧
          -  音韻は発話内容や言語に依存する
       -  話者固有の情報のみを強調した話者埋め込み(固有次元ベクトル, speaker embedding)を特徴量系列から抽出する
          -  生成モデルに基づく手法
          -  話者識別DNN(deep neural network)に基づく手法
   - 生成モデルに基づく話者埋め込み
     - 2000年ごろから(`../2nd/2nd.md`の内容はこれ)
     - 音声が話者固有のGMMに従うと仮定
     - UBMと話者に適合させたGMMの差(GMMスーパベクトル)を話者埋め込みとする
       - 因子分析によってこの次元を削減して得たi-vectorは良い性能を得ていた
   - 深層話者埋め込み
     - i-vectorに置き換わる形で近年急速に発展
     - `{解説記事}/fig-4`の構造を持つDNNを用いて話者埋め込みを得る
       - Encoderで時間フレーム単位で特徴抽出
       - プーリング層で時間方向に集約
       - 話者認識部で，集約したベクトルから話者を推定
     - 大量の学習データでパラメータを推定する
     - 話者認識部の中間出力(ベクトル)は，話者識別に重要な情報が詰まってるんじゃないの?
       - 深層話者埋め込み(x-vector)
3. バックエンド処理
   - 登録音声，照合音声からそれぞれ話者埋め込み(ベクトル)を得，照合スコアを算出
     - コサイン類似度
     - PLDA(Probabilistic linear discriminant analysis)
   - 異なる話者において，発話間の照合スコア分布が標準正規分布になるようにスコアを正規化
   - 閾値で切って受理or棄却
## 深層話者埋め込みの最新技術
DNNの具体的な構造として，様々なモデルや学習法が提案されている
### エンコーダ
  - 一次元畳み込み
    - TDNN(Time delay neural network)
      - `{解説記事}/fig-5`
      - 時間方向の畳み込み
      - 畳み込み時の膨張係数をを層ごとに層ごとに徐々に大きくすることで，少ないパラメータで長いコンテキスト(多い時間フレーム)を考慮できる
      - 扱えるコンテキストを大きくしたり，パラメータ数を減らすなど，多くの拡張方法が提案されている
  - 二次元畳み込み
    - ResNet
      - Residual Network
      - 時間・周波数方向への畳み込みと残差接続を組み合わせたもの
      - よく用いられる
      - 様々な構造が提案されている
        - 画像認識で使われるResNetやその拡張であるRepVGGをそのまま使う
        - ResNetの前段にBLSTM(bi-directional long short-term memory)を配置する
### プーリング層
  - SP
    - 初期に用いられていた
    - 特徴系列の次元ごとに平均・分散を算出し，これらを連結したベクトルを出力
      - 2*特徴系列次元になる_?
  - SPの拡張
    - ASP
      - 全接続DNNでフレームごとに算出した重みに基づき加重平均と分散を算出する
    - SAP
      - フレームごとに複数の重みを算出する
  - MQMHA
    - Multi-query multi-head attention pooling mechanism
    - 特徴系列を次元方向に複数のグループに分けて，グループごとに複数の重みを算出する
  - xi-vector
    - 入力音声の曖昧さを考慮したプーリングが可能
    - エンコーダ出力を時間依存の線形ガウス分布でモデル化し，その共分散行列を全接続DNNで推定する
### 目的関数
  - 最適化問題における，最適化対象の関数
  - モデルの学習において，これが最小となるようにパラメータを調整する
  - ソフトマックス交差エントロピーが一般的
    - 話者予測ベクトルと，正解ラベルのone-hotベクトルの交差エントロピー
      - 話者予測ベクトル
        - 話者数*1次元，各要素は[0,1]，全要素の和が1(ソフトマックス)の
      - 交差エントロピー
        - `machine-learning-book/14.2.3`
        - エントロピー: 乱雑度合
        - 予測ベクトルと正解ベクトルを見つめて，乱雑な(形がかけ離れている)ほど交差エントロピーが大きくなる_?
        - 形が似かよった(交差エントロピーが小さくなる)方向にパラメータを調整する_?
  - AAM softmax
    - additive angular-margin softmax
    - マージンを考慮した目的関数
  - 距離学習に基づく目的関数
    - 話者埋め込み間の距離を目的関数とする
      - 同じ話者なのだから，異なる音声から得られる話者埋め込みは本来同じになるべきだ_?
      - pair-wise loss
      - contrastive lossなど
### 学習アルゴリズム
  - 深層話者埋め込みは学習データを増やしたときの性能改善が大きい
    - 学習データを加工してデータ数を増やす(データ拡張)
      - 雑音の重畳，残響環境下で収録したインパルス応答の畳み込み
      - SpecAugment
        - 音響特徴量の一部を隠す
      - speed perturbation
        - 発話速度を変える
      - mixup
        - 複数の音声を混ぜる
      - 話者拡張
        - ピッチや話者速度を変換(話者の特徴が大きく変わる)し，変換後の音声を新たな話者によるものとみなす
  - 比較: `{解説記事}/fig-6`
## ワークショップの動向
電話対応音声(これまでの中心)に加え，Web動画やビデオログ等，多種多様なメディアの話者照合に関心が移りつつある．
遠隔発話の課題から，異なる言語・メディア間など，より難しいタスクが設定される傾向に．
顔画像と音声の両方を用いた認識(NIST-SRE)や教師無しデータからの構築なども行われている．
## 課題と今後の展望
発展が期待されるアプローチは次のよう．

### 音声波形の直接利用
  - これまでは既存のフィルタに基づいて特徴量を抽出
  - 学習可能なフィルタをエンコーダに組み込み，特徴量抽出自体も話者識別基準で最適化する
    - モデルに音声波形を直接渡す(今までは特徴抽出してから渡していた)
  - Wav2Spk
    - 時間領域の畳み込みをエンコーダに組み込んだ
    - 従来の特徴量抽出と同等以上
  - sincNet, RawNet2
    - 畳み込みフィルタの形状をsinc関数に限定することでピッチやフォルマントなど，話者の識別に有効な特徴を抽出できるフィルタを自動的に取得できることを示した
    - 説明可能性も考慮されている
  - 複素領域での畳み込みなど
    - 今まで位相は無視されていた
### エンドツーエンド話者照合
  - フロントエンド・バックエンドは，DNNとスコア算出は独立
  - 登録・照合音声のペアから直接スコアを計算
    - 距離学習に基づく手法もこの1つ
  - 話者照合の評価尺度を最小化する
    - AUC
    - CLLR, cost of log lilelihood ratio
  - バックエンドのPLDAとともに最適化するNeuralPLDAなど
### モデルサイズ
  - モバイル端末や低資源環境での実行可能性の向上
### 他タスクとの結合学習
  - 方向推定と組み合わせる
  - DNNベースの音声強調と同時に最適化
### 環境に対する頑健性
  - 雑音，収録チャネル，言語等の音環境
  - DNNの学習データと照合時の音声で環境が異なると性能が下がってしまう
    - 運用環境下の大量の音声を用いてモデル改善を行う教師無しモデル適応法
    - 敵対的学習により音環境の違いに対し不変となるようにモデルを学習させる
    - 各音環境下の話者埋め込みの分布間距離を最小化
  - どの環境変数がどの程度影響するかはっきり分かっていない
    - 言語のミスマッチは問題とならない
    - 収録チャネルのミスマッチは正規化である程度解消される
    - 発話スタイルのミスマッチは，結構性能が落ちてしまう
## なりすまし攻撃とその対策
### なりすまし攻撃の種類
- 論理的アクセス
  - LA, logical access
  - マイクを介さず直接なりすまし音声を入力
  - 音声合成や声質変換で生成した音声
- 物理的アクセス
  - PA, phisical ascess
  - なりすまし音声を照合システムのマイクを通じて入力
  - リプライ攻撃
    - 事前に収録した音声を再生する
#### 直列型システム
- 照合システムに渡す前に，なりすまし音声か否かの二値分類を行う
  - なりすましと判断したものは棄却
- 照合システムに手を加えなくてよい

### ASVspoof challenge
- 2015から隔年開催の競争型評価ワークショップ
- なりすまし音声検出単体の精度だけでなく，既存の照合システムと組み合わせたときの，システム全体のなりすまし攻撃に対する耐性を評価
- 未知の攻撃に対する頑健性を重視
  - 評価セットの音声は学習データとは異なる条件で生成
    - 収録機器，再生機器，コーデック，再生環境等
- LA,PAを想定したタスクに加え，DF(Deep fake)タスクが加えられている
  - 多くの未知合成アルゴリズム音声を追加し，純粋になりすまし音声の検出精度を競う
### 研究動向
#### 音響特徴量の抽出
  - スペクトラム包絡に基づく特徴が広く用いられる
    - MFCC
    - LFCC
      - linear frequency Cepstrum coefficients
    - メルスペクトログラム等のスペクトル特徴が特に有効と報告
    - Constant-Q変換
      - 低周波数帯域でより詳細な周波数解像度を持つ
      - 合成音声の種類によっては有効
  - sincNetのような，特徴量抽出も最適化の対象とする枠組みも積極的に導入
#### バックエンド
- 実音声と，なりすまし音声で学習したGMMに対する尤度比
  - 広く用いられていた
- DNNを用いて検出スコアを直接推定
  - LFCCを直接入力とするLight CNN
  - 音声波形を入力とするRawNet2を，なりすましか否かの識別に対するソフトマックス交差エントロピー基準で最適化する
- 様々なデータ拡張を組み合わせることで，未知のコーデックに対する頑健性を確保している
### 課題と今後
合成・リプライ音声のどちらにおいても，学習時と評価時で条件が異なる未知の攻撃に対しては精度が低い．
- 汎化性能の向上が課題
- 積極的な攻撃に対する対策も求められる
  - 話者認識システムを騙すように最適化された合成音声
  - 攻撃対象の話者照合システムの誤受理率を上げるようなノイズを付加した敵対的サンプルに基づく攻撃
- 呼気がマイクロホンに入ることによるポップノイズを用いた生体検知に基づく方法もある